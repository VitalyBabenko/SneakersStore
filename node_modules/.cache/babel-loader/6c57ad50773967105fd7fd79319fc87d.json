{"ast":null,"code":"import _asyncToGenerator from\"/Users/Vitaliy/Desktop/web/react/sneakers/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/Vitaliy/Desktop/web/react/sneakers/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/Users/Vitaliy/Desktop/web/react/sneakers/node_modules/@babel/runtime/regenerator/index.js\";import styles from'./Drawer.module.scss';import React from'react';import axios from'axios';import Info from'../Info';import{useCart}from'../hooks/useCart';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var delay=function delay(ms){return new Promise(function(resolve){return setTimeout(resolve,ms);});};function Drawer(_ref){var mockApi=_ref.mockApi,onClose=_ref.onClose,onRemove=_ref.onRemove,_ref$items=_ref.items,items=_ref$items===void 0?[]:_ref$items,opened=_ref.opened;var _useCart=useCart(),cartItems=_useCart.cartItems,setCartItems=_useCart.setCartItems,totalPrice=_useCart.totalPrice;var _React$useState=React.useState(null),_React$useState2=_slicedToArray(_React$useState,2),OdrerId=_React$useState2[0],setOrderId=_React$useState2[1];var _React$useState3=React.useState(false),_React$useState4=_slicedToArray(_React$useState3,2),isOdrerComplite=_React$useState4[0],setOrderCoplite=_React$useState4[1];var _React$useState5=React.useState(false),_React$useState6=_slicedToArray(_React$useState5,2),isLoading=_React$useState6[0],setIsLoading=_React$useState6[1];var onClickOrder=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _yield$axios$post,data,i,item;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;setIsLoading(true);_context.next=4;return axios.post(\"\".concat(mockApi,\"orders\"),{items:cartItems});case 4:_yield$axios$post=_context.sent;data=_yield$axios$post.data;setOrderId(data.id);setOrderCoplite(true);setCartItems([]);i=0;case 10:if(!(i<cartItems.length)){_context.next=19;break;}item=cartItems[i];_context.next=14;return axios.delete(\"\".concat(mockApi,\"cart/\")+item.id);case 14:_context.next=16;return delay(1000);case 16:i++;_context.next=10;break;case 19:_context.next=24;break;case 21:_context.prev=21;_context.t0=_context[\"catch\"](0);alert('Не удалось создать заказ');case 24:setIsLoading(false);case 25:case\"end\":return _context.stop();}}},_callee,null,[[0,21]]);}));return function onClickOrder(){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsx(\"div\",{className:\"\".concat(styles.overlay,\" \").concat(opened?\"\".concat(styles.overlayVisible):\"\"),children:/*#__PURE__*/_jsxs(\"div\",{className:styles.drawer,children:[/*#__PURE__*/_jsxs(\"h2\",{children:[\"\\u041A\\u043E\\u0440\\u0437\\u0438\\u043D\\u0430\",/*#__PURE__*/_jsx(\"img\",{onClick:onClose,className:styles.removeBtn,src:\"img/btn-remove.svg\",alt:\"Remove\"})]}),items.length>0?/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex flex-column flex\",children:[/*#__PURE__*/_jsx(\"div\",{className:styles.cartItems,children:items.map(function(obj){return/*#__PURE__*/_jsxs(\"div\",{className:styles.cartItem,children:[/*#__PURE__*/_jsx(\"div\",{style:{backgroundImage:\"url(\".concat(obj.imageUrl,\")\")},className:styles.cartItemImg}),/*#__PURE__*/_jsxs(\"div\",{className:\"mr-20 flex\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"mb-5\",children:obj.title}),/*#__PURE__*/_jsxs(\"b\",{children:[obj.price,\"\\u0433\\u0440\\u043D.\"]})]}),/*#__PURE__*/_jsx(\"img\",{onClick:function onClick(){return onRemove(obj.id);},className:styles.removeBtn,src:\"img/btn-remove.svg\",alt:\"Remove\"})]},obj.id);})}),/*#__PURE__*/_jsxs(\"div\",{className:styles.cartTotalBlock,children:[/*#__PURE__*/_jsxs(\"ul\",{children:[/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\u0418\\u0442\\u043E\\u0433\\u043E:\"}),/*#__PURE__*/_jsx(\"div\",{}),/*#__PURE__*/_jsxs(\"b\",{children:[totalPrice,\" \\u0433\\u0440\\u043D.\"]})]}),/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\u041D\\u0430\\u043B\\u043E\\u0433 5%:\"}),/*#__PURE__*/_jsx(\"div\",{}),/*#__PURE__*/_jsxs(\"b\",{children:[\" \",totalPrice/100*5,\" \\u0433\\u0440\\u043D. \"]})]})]}),/*#__PURE__*/_jsxs(\"button\",{disabled:isLoading,onClick:onClickOrder,className:styles.greenButton,children:[\"\\u041E\\u0444\\u043E\\u0440\\u043C\\u0438\\u0442\\u044C \\u0437\\u0430\\u043A\\u0430\\u0437\",/*#__PURE__*/_jsx(\"img\",{src:\"img/arrow.svg\",alt:\"arrow\"})]})]})]}):/*#__PURE__*/_jsx(Info,{image:isOdrerComplite?'img/complited-order.jpg':'img/empty-cart.png',title:isOdrerComplite?'Заказ оформлен!':'Корзина пустая',discription:isOdrerComplite?\"\\u0412\\u0430\\u0448 \\u0437\\u0430\\u043A\\u0430\\u0437 \\u2116\".concat(OdrerId,\" \\u0441\\u043A\\u043E\\u0440\\u043E \\u0431\\u0443\\u0434\\u0435\\u0442 \\u043F\\u0435\\u0440\\u0435\\u0434\\u0430\\u043D \\u043A\\u0443\\u0440\\u044C\\u0435\\u0440\\u0441\\u043A\\u043E\\u0439 \\u0434\\u043E\\u0441\\u0442\\u0430\\u0432\\u043A\\u0435\"):'Добавьте хотя бы одну пару кроссовок, чтобы сделать заказ.',imgWidth:isOdrerComplite?'83px':'120px'})]})});}export default Drawer;","map":{"version":3,"sources":["/Users/Vitaliy/Desktop/web/react/sneakers/src/components/Drawer/index.js"],"names":["styles","React","axios","Info","useCart","delay","ms","Promise","resolve","setTimeout","Drawer","mockApi","onClose","onRemove","items","opened","cartItems","setCartItems","totalPrice","useState","OdrerId","setOrderId","isOdrerComplite","setOrderCoplite","isLoading","setIsLoading","onClickOrder","post","data","id","i","length","item","delete","alert","overlay","overlayVisible","drawer","removeBtn","map","obj","cartItem","backgroundImage","imageUrl","cartItemImg","title","price","cartTotalBlock","greenButton"],"mappings":"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","sourcesContent":["import styles from './Drawer.module.scss';\nimport React from 'react';\nimport axios from 'axios'\nimport Info from '../Info';\nimport { useCart } from '../hooks/useCart';\n\n\nconst delay = (ms) => new Promise((resolve) => setTimeout(resolve, ms));\n\nfunction Drawer({ mockApi, onClose, onRemove, items = [], opened }) {\n   const { cartItems, setCartItems, totalPrice } = useCart()\n\n   const [OdrerId, setOrderId] = React.useState(null);\n   const [isOdrerComplite, setOrderCoplite] = React.useState(false);\n   const [isLoading, setIsLoading] = React.useState(false);\n\n\n   const onClickOrder = async () => {\n      try {\n         setIsLoading(true)\n         const { data } = await axios.post(`${mockApi}orders`, {\n            items: cartItems,\n         });\n         setOrderId(data.id);\n         setOrderCoplite(true);\n         setCartItems([]);\n\n         for (let i = 0; i < cartItems.length; i++) {\n            const item = cartItems[i]\n            await axios.delete(`${mockApi}cart/` + item.id);\n            await delay(1000);\n         }\n      } catch (error) {\n         alert('Не удалось создать заказ')\n      }\n      setIsLoading(false)\n   };\n\n   return (\n      <div className={`${styles.overlay} ${opened ? `${styles.overlayVisible}` : \"\"}`}>\n         <div className={styles.drawer}>\n            <h2>\n               Корзина\n               <img onClick={onClose} className={styles.removeBtn} src=\"img/btn-remove.svg\" alt=\"Remove\" />\n            </h2>\n\n            {items.length > 0 ? (\n               <div className='d-flex flex-column flex' >\n                  <div className={styles.cartItems}  >\n                     {items.map((obj) => (\n                        <div key={obj.id} className={styles.cartItem} >\n                           <div\n                              style={{ backgroundImage: `url(${obj.imageUrl})` }}\n                              className={styles.cartItemImg}>\n                           </div>\n                           <div className=\"mr-20 flex\" >\n                              <p className=\"mb-5\" >{obj.title}</p>\n                              <b>{obj.price}грн.</b>\n                           </div>\n                           <img\n                              onClick={() => onRemove(obj.id)}\n                              className={styles.removeBtn}\n                              src=\"img/btn-remove.svg\"\n                              alt=\"Remove\" />\n                        </div>\n                     ))}\n                  </div>\n                  <div className={styles.cartTotalBlock} >\n                     <ul >\n                        <li >\n                           <span>Итого:</span>\n                           <div>\n                           </div>\n                           <b>{totalPrice} грн.</b>\n                        </li>\n                        <li>\n                           <span >Налог 5%:</span>\n                           <div></div>\n                           <b> {totalPrice / 100 * 5} грн. </b>\n                        </li>\n                     </ul>\n                     <button disabled={isLoading} onClick={onClickOrder} className={styles.greenButton}>\n                        Оформить заказ\n                        <img src='img/arrow.svg' alt=\"arrow\" />\n                     </button>\n                  </div>\n\n               </div>\n            ) : (\n               <Info\n                  image={isOdrerComplite ? 'img/complited-order.jpg' : 'img/empty-cart.png'}\n                  title={isOdrerComplite ? 'Заказ оформлен!' : 'Корзина пустая'}\n                  discription={isOdrerComplite ? `Ваш заказ №${OdrerId} скоро будет передан курьерской доставке` : 'Добавьте хотя бы одну пару кроссовок, чтобы сделать заказ.'}\n                  imgWidth={isOdrerComplite ? '83px' : '120px'}\n               />\n            )}\n         </div>\n      </div >\n   );\n}\n\nexport default Drawer;"]},"metadata":{},"sourceType":"module"}